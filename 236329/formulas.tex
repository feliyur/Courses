% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{margin=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!
\newcommand{\norm}[2][]{{\|#2\|}_{#1}}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\convhull}{ConvHull}

%\def\labelitemi{--}

%%% END Article customizations

%%% The "real" document content comes below...

\title{Brief Article}
\author{The Author}
%\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\maketitle

\section{Problem statement}

\begin{description}
	\item{$\Omega\subset \mathbb{R}^2$ or $\mathbb{R}^3$ --} the domain, i.e. the shape we operate on
	\item{$H_j \subset \Omega, \; j=1,...,m$ --} control handles. A handle can be single point, region, skeleton bone or a cage vertex
\end{description}
The user defines an affine transformation $T_j\in \mathbb{R}^ {2x3}$ or $\mathbb{R}^ {3x4}$ for each handle $H_j$  \\
Every point $p\in \Omega$ is deformed according to: 
\[
	p' = \sum_{j=1}^m w_j(p)\, T_jp  = \sum_{j=1}^m w_j(p)\, \left( T_jp \right) = \left( \sum_{j=1}^m w_j(p)\, T_j \right) \cdot p
\]

\subsection{A subsection}

More text.

\section{Setting the Weights}
\[
	W \leftarrow \argmin_{w_j,\enspace  j=1,...,m} \sum_{j=1}^m \frac{1}{2} \int_\Omega \norm{\Delta w_j}^2 dV
\]
\[
	W \in \mathbb{R}^{|V|\times m}
\]
subject to: 
\begin{enumerate}[label=\arabic*)]
	\item $w_j |_{\raisebox{-1pt}{\tiny $H_k$}} = \delta_{jk}$
	\item $w_j |_{\raisebox{-1pt}{\tiny $F$}} \; \text{is linear} \enspace \forall F\in \mathcal{F}_C $
	\item $\displaystyle\sum_{j=1}^ m w_j(p) = 1 \quad \forall p\in \Omega$
	\item $0\leq w_j(p) \leq 1, \, j=1,...,m \quad \forall p \in \Omega$
\end{enumerate}
\[
	\sum_{j=1}^m \frac{1}{2} \int_\Pi \rho \norm{\nabla w_j}^2 dV
\]
\[
	\sum_{j=1}^m \frac{1}{2} \int_\Omega \norm{\Delta w_j}^2 dV + \sum_{j=1}^m \frac{1}{2} \int_\Pi \rho \norm{\nabla w_j}^2 dV
\]
\section{Properties}
\[
	( \displaystyle\sum_{j=1}^ m w_j(p) = 1 \quad \text{for every } p\in \Omega )
\]

$\displaystyle\sum_{j=1}^ m w_j(p) = 1 \quad \forall p\in \Omega$ along with $p' = \underbrace{\left( \sum_{j=1}^m w_j(p)\, T_j \right)}_{T_p} \cdot p$ 

$T_p \in \convhull \left( \{ T_j \} \right) $

\section{Implementation}
\[
	\sum_{j=1}^m \frac{1}{2}\int_\Omega \norm{\Delta w_j}^2 dV \,\approx\, \sum_{j=1}^m \frac{1}{2} (M^{-1}Lw_j)^TM(M^{-1}Lw_j)\, =\, \frac{1}{2}\sum_{j=1}^m w_j^T (LM^{-1}L)w_j
\]
\[
	\sum_{j=1}^m \frac{1}{2} \int_\Pi \rho \norm{\nabla w_j}^2 dV \approx \sum_{j=1}^m \frac{1}{2} w_j^T(G^TR\bar{M}G)w_j
\]
\[
	\argmin_{w_j,\enspace  j=1,...,m} \frac{1}{2}\sum_{j=1}^m w_j^T (LM^{-1}L)w_j + \sum_{j=1}^m \frac{1}{2} w_j^T(G^TR\bar{M}G)w_j
\]
subject to: 
\begin{enumerate}[label=\arabic*)]
	\item $w_j |_{\raisebox{-1pt}{\tiny $H_k$}} = \delta_{jk}$
	\item $w_j |_{\raisebox{-1pt}{\tiny $F$}} \; \text{is linear} \enspace \forall F\in \mathcal{F}_C $
	\item $\displaystyle\sum_{j=1}^ m w_j(p) = 1 \quad \forall p\in \Omega$
	\item $0\leq w_j(p) \leq 1, \, j=1,...,m \quad \forall p \in \Omega$
\end{enumerate}

\end{document}
